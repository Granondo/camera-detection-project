# Camera Detection Project

–°–∏—Å—Ç–µ–º–∞ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è IP-–∫–∞–º–µ—Ä Tapo —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π RTSP.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìπ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–∞–º–µ—Ä–∞–º Tapo —á–µ—Ä–µ–∑ RTSP
- üéØ –î–µ—Ç–µ–∫—Ü–∏—è –ª—é–¥–µ–π –∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- üê≥ Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚öôÔ∏è –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Go 1.21+
- OpenCV 4.x
- –ö–∞–º–µ—Ä–∞ Tapo —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π RTSP

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ OpenCV

#### Ubuntu/Debian
```bash
sudo apt update
sudo apt install -y libopencv-dev
# –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Makefile
make install-opencv
```

#### macOS
```bash
brew install opencv
# –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Makefile
make install-opencv-mac
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
git clone <repository-url>
cd camera-detection-project
make setup
make install-deps
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–º–µ—Ä—ã

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∞ –∫–∞–º–µ—Ä–∞ Tapo C220 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è RTSP:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Tapo
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã
3. –í–∫–ª—é—á–∏—Ç–µ RTSP Stream
4. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 4. –ó–∞–ø—É—Å–∫

```bash
# –û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
make run

# –ó–∞–ø—É—Å–∫ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
make run-dev

# –ó–∞–ø—É—Å–∫ –≤ Docker
make docker-run
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `RTSP_URL` | RTSP URL –∫–∞–º–µ—Ä—ã | `rtsp://192.168.1.100:554/stream1` |
| `CAMERA_USERNAME` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | `admin` |
| `CAMERA_PASSWORD` | –ü–∞—Ä–æ–ª—å | _(–ø—É—Å—Ç–æ–π)_ |
| `CAMERA_TIMEOUT` | –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Å–µ–∫) | `30` |
| `FRAME_RATE` | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π N-–π –∫–∞–¥—Ä | `5` |
| `SAVE_FRAMES` | –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞–¥—Ä—ã –Ω–∞ –¥–∏—Å–∫ | `true` |
| `OUTPUT_DIR` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è | `./output` |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
camera-detection-project/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ main.go
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ camera/            # RTSP –∫–ª–∏–µ–Ω—Ç –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ camera.go      # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π RTSP –∫–ª–∏–µ–Ω—Ç  
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ simple_camera.go # –ü—Ä–æ—Å—Ç–æ–π –∫–ª–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ OpenCV
‚îÇ   ‚îú‚îÄ‚îÄ config/            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.go
‚îÇ   ‚îú‚îÄ‚îÄ detector/          # ML –º–æ–¥–µ–ª–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ storage/           # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ output/                # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞–¥—Ä—ã
‚îú‚îÄ‚îÄ go.mod
‚îú‚îÄ‚îÄ go.sum  
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ Makefile
‚îî‚îÄ‚îÄ README.md
```

## –ü–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –∫–∞–º–µ—Ä–µ

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
   ```bash
   ping 192.168.1.100  # –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–π –∫–∞–º–µ—Ä—ã
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ RTSP –ø–æ—Ç–æ–∫:**
   ```bash
   ffplay rtsp://admin:password@192.168.1.100:554/stream1
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Tapo**

### –û—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏

1. **OpenCV –Ω–µ –Ω–∞–π–¥–µ–Ω:**
   ```bash
   # Ubuntu/Debian
   sudo apt install libopencv-dev pkg-config

   # macOS
   brew install opencv pkg-config
   ```

2. **Go –º–æ–¥—É–ª–∏:**
   ```bash
   go mod download
   go mod tidy
   ```

## Docker

### –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
make docker-build

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run --rm \
  -e RTSP_URL="rtsp://192.168.1.100:554/stream1" \
  -e CAMERA_USERNAME="admin" \
  -e CAMERA_PASSWORD="password" \
  -v $(pwd)/output:/app/output \
  camera-detection-project:latest
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
make help           # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
make check          # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ (fmt + vet + test)
make clean          # –û—á–∏—Å—Ç–∫–∞
make test           # –¢–µ—Å—Ç—ã
```

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–µ–∫—Ü–∏—é –æ–±—ä–µ–∫—Ç–æ–≤ (YOLO/TensorFlow)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- [ ] –°–æ–∑–¥–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "–ü–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º"
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. –°–æ–∑–¥–∞–π—Ç–µ issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã